<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>填坑之路</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="icon.png">
    <meta name="description" content="填坑日记">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.b0476a2d.js" as="script"><link rel="preload" href="/assets/js/2.fe518ebb.js" as="script"><link rel="preload" href="/assets/js/4.decb33c7.js" as="script"><link rel="prefetch" href="/assets/js/10.aabc5f74.js"><link rel="prefetch" href="/assets/js/11.0d34042a.js"><link rel="prefetch" href="/assets/js/12.ffb0a834.js"><link rel="prefetch" href="/assets/js/13.f8364c88.js"><link rel="prefetch" href="/assets/js/14.681edb1e.js"><link rel="prefetch" href="/assets/js/15.c690ccc3.js"><link rel="prefetch" href="/assets/js/16.73fc9600.js"><link rel="prefetch" href="/assets/js/17.852ee09d.js"><link rel="prefetch" href="/assets/js/18.e9a2c831.js"><link rel="prefetch" href="/assets/js/19.1077413e.js"><link rel="prefetch" href="/assets/js/20.6302a09d.js"><link rel="prefetch" href="/assets/js/3.670af10e.js"><link rel="prefetch" href="/assets/js/5.283e286b.js"><link rel="prefetch" href="/assets/js/6.1e6aac85.js"><link rel="prefetch" href="/assets/js/7.5edf4f36.js"><link rel="prefetch" href="/assets/js/8.f7e247e3.js"><link rel="prefetch" href="/assets/js/9.5216cbd1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">填坑之路</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/base/js/define.html" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/base/summary/http.html" class="nav-link">
  综合素质
</a></div><div class="nav-item"><a href="/base/record/test.html" class="nav-link">
  练习
</a></div><div class="nav-item"><a href="/diary/summary.html" class="nav-link">
  札记
</a></div> <a href="https://github.com/mahalo777/mahalo777.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/base/js/define.html" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/base/summary/http.html" class="nav-link">
  综合素质
</a></div><div class="nav-item"><a href="/base/record/test.html" class="nav-link">
  练习
</a></div><div class="nav-item"><a href="/diary/summary.html" class="nav-link">
  札记
</a></div> <a href="https://github.com/mahalo777/mahalo777.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/base/js/define.html" class="sidebar-link">JS语言定义</a></li><li><a href="/base/js/scope.html" class="sidebar-link">作用域与闭包</a></li><li><a href="/base/js/eventLoop.html" class="sidebar-link">事件循环</a></li><li><a href="/base/js/context.html" class="sidebar-link">执行上下文</a></li><li><a href="/base/js/proto.html" class="sidebar-link">原型</a></li><li><a href="/base/js/this.html" class="sidebar-link">this</a></li><li><a href="/base/js/extend.html" class="sidebar-link">面向对象相关</a></li><li><a href="/base/js/jingfen1.html" aria-current="page" class="active sidebar-link">精分现场-预编译</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>记录神经现场～～～～</p> <h3 id="神经初期-所谓的预编译"><a href="#神经初期-所谓的预编译" class="header-anchor">#</a> 神经初期（所谓的预编译）</h3> <p><img src="/assets/img/unjs1.a30cffa6.png" alt="ujs1"></p> <p><strong>读到1我有了一个疑问，所以这是变量提升吗？那么变量提升是在编译阶段吗？</strong></p> <ul><li><p>于是我们开始查询资料，看看有没有详细的说明。<a href="https://mengsixing.github.io/blog/js-principle.html#%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B" target="_blank" rel="noopener noreferrer">JS 编译器，解释引擎 | 前端日志 (mengsixing.github.io)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 这文章讲：生成机器码后才开始预编译和变量提升。咦这跟书对不上。这个很离谱。</p></li> <li><p><a href="https://segmentfault.com/a/1190000013126460" target="_blank" rel="noopener noreferrer">JavaScript到底是解释型语言还是编译型语言? - SegmentFault 思否<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ，读完：分词和AST不是编译器的工作吗，当然说是引擎也没啥问题，毕竟调度都是引擎的工作。这个和书上讲的类似：在AST-&gt;生成机器码之间的某个过程，发生了预编译和变量提升。翻译的文章就权威了？？？</p></li></ul> <p>我们查了很多文章，都只是说了：<em><strong>在真正执行代码<strong><strong>前</strong></strong>，会有预编译阶段，这个阶段收集变量声明。</strong></em> <em><strong>那么这个阶段对应到v8哪个步骤呢？是这个中间过程，所谓的“预编译”？？</strong></em></p> <p>于是我们再查资料，我们开始探索V8。</p> <h3 id="神经中期-确认阶段"><a href="#神经中期-确认阶段" class="header-anchor">#</a> 神经中期（确认阶段）</h3> <p>于是我们开始新的探索；</p> <ul><li>阶段1：搜索预解析，pre-parser莫名搜到了惰性解析，莫名学习了一波，甚至直接看的英文文章</li> <li>阶段2：从某个文章开始看图解V8，<strong>图解V8说：解析器解析过程会生成AST和作用域，确认作用域阶段会发生变量提升。我开始确认是生成AST阶段。</strong></li> <li>阶段3：然后搜索生成AST和作用域的先后？然后知道了预解析和全解析，预解析有些文章说不生成AST，有些说生成**，但是他们都生成作用域，好耶！！！！**</li> <li>阶段4：<a href="https://segmentfault.com/q/1010000038371425?sort=newest" target="_blank" rel="noopener noreferrer">https://segmentfault.com/q/1010000038371425?sort=newest<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ？图解V8说的不对吗？？
<ul><li>结合：<a href="https://hungryturbo.com/pages/fa7f62/#%E8%A7%A3%E6%9E%90%E5%99%A8-parser" target="_blank" rel="noopener noreferrer">教女朋友学前端之深入理解JS引擎 | 童欧巴博客 (hungryturbo.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>花钱买了！<a href="https://xiaozhuanlan.com/topic/1946507283" target="_blank" rel="noopener noreferrer">https://xiaozhuanlan.com/topic/1946507283<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>抓狂😫：是生成了执行上下文，还是作用域？？</li></ul></li></ul> <p><strong>终于我的得出了结论，全文重点⬇️</strong>：</p> <ol><li><strong>在懒惰解析生成AST的过程，会发生两种解析：预解析与全量解析。</strong></li> <li><strong>遇到不立即执行的函数，就进行预解析，从而生成 AST，会产生不带有变量引用和声明的 scopes 信息（这项工作由 Pre-Parser 预解析器完成）</strong></li> <li><strong>遇到立即执行的函数，或者被调用的函数，进行全量解析，生成AST和作用域信息（也可以理解为是执行上下文的创建阶段）</strong></li></ol> <p><strong>至此说服了自己，变量提升和作用域确定发生在生成AST阶段</strong>。见补图小小论证。</p> <h3 id="神经晚期-回顾总结阶段"><a href="#神经晚期-回顾总结阶段" class="header-anchor">#</a> 神经晚期（回顾总结阶段）</h3> <p>开始回归书本，虽然这段话没指明是那个阶段，但是我们知道是生成机器码前的某个阶段。
38页也很好的说明了，<strong>编译阶段中的一部分工作就是找到所有变量声明，并用合适的作用域将他们关联起来。</strong>
我们迷惑的点在于：**是生成AST阶段呢，还是在执行机器码之前的所谓“预编译”？**这本书写时，应该没有V8，应该也没过度追究细节。我们自己知道因为时间和发展原因，大概有2种理解就好。⬇️⬇️</p> <p>至此，我的结论是：<strong>变量提升发生在生成AST阶段，这个阶段确定了作用域信息</strong>。如果以后的面试官说：在AST-&gt;执行代码之间的预编译阶段，我只能勉强的同意了。</p> <h3 id="神经衰弱-个人总结"><a href="#神经衰弱-个人总结" class="header-anchor">#</a> 神经衰弱（个人总结）</h3> <p>在查资料的过程中，一直在论证学习。很多文章写的不一定是对的，他只是抄的。如果我直接看V8文档就不用怀疑真假了吧.......
这个过程和记录这个过程花了很长时间(大概2天)，以后尽量避免这种牛角尖。</p> <p><strong>终于我说服了部分自己！！！！</strong></p> <p><strong><em>另外：中文博客就是互相抄。</em></strong></p> <p><strong><em>需要补充学习：执行上下文。</em></strong></p> <h3 id="补充图解v8"><a href="#补充图解v8" class="header-anchor">#</a> 补充图解V8</h3> <p><img src="/assets/img/v83.084d00d0.png" alt="v83"> <img src="/assets/img/v84.0ea66b6e.jpeg" alt="v84"></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/base/js/extend.html" class="prev">
        面向对象相关
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b0476a2d.js" defer></script><script src="/assets/js/2.fe518ebb.js" defer></script><script src="/assets/js/4.decb33c7.js" defer></script>
  </body>
</html>
